{"version":3,"sources":["../../server/socketio/socketServer.js"],"names":["sockets","users","socket","socketServer","io","on","client","push","lastConnected","id","console","log","length","key","splice","indexOf","username","emit","listen"],"mappings":";;;;;;AAAA;;;;;;AAEA,IAAMA,UAAU,EAAhB;AACA,IAAMC,QAAQ,EAAd;AACA,IAAIC,SAAS,IAAb;;AAEA,IAAMC,eAAe,SAAfA,YAAe,CAACC,EAAD,EAAQ;AACzBA,OAAGC,EAAH,CAAM,YAAN,EAAoB,UAACC,MAAD,EAAY;AAC5BJ,iBAASI,MAAT;AACAN,gBAAQO,IAAR,CAAaD,MAAb;AACAL,cAAMO,aAAN,GAAsBF,OAAOG,EAA7B;AACAC,gBAAQC,GAAR,CAAY,kBAAZ;AACAD,gBAAQC,GAAR,CAAYX,QAAQY,MAApB;AACAN,eAAOD,EAAP,CAAU,YAAV,EAAwB,YAAM;AAC1BK,oBAAQC,GAAR,CAAY,mBAAZ;AACA,iBAAK,IAAIE,GAAT,IAAgBZ,KAAhB,EAAuB;AACnB,oBAAIA,MAAMY,GAAN,MAAeP,OAAOG,EAA1B,EAA8B;AAC1B,2BAAOR,MAAMY,GAAN,CAAP;AACA;AACH;AACJ;AACDb,oBAAQc,MAAR,CAAed,QAAQe,OAAR,CAAgBT,MAAhB,CAAf,EAAwC,CAAxC;AACAJ,qBAAS,IAAT;AACH,SAVD;AAWAI,eAAOD,EAAP,CAAU,OAAV,EAAmB,gBAAgB;AAAA,gBAAdW,QAAc,QAAdA,QAAc;;AAC/BN,oBAAQC,GAAR,CAAY,iBAAZ,EAA+BK,QAA/B;AACAV,mBAAOW,IAAP,CAAY,aAAZ,EAA2B,EAACD,UAAU,WAAX,EAA3B;AACH,SAHD;AAIH,KArBD;;AAuBAZ,OAAGc,MAAH,CAAU,IAAV;AACAR,YAAQC,GAAR,CAAY,2BAAZ;AACA,WAAOP,EAAP;AACH,CA3BD;;kBA6Be;AACXD,8BADW;AAEXH,oBAFW;AAGXE,kBAHW;AAIXD;AAJW,C","file":"socketServer.js","sourcesContent":["import db from '../models/index'\n\nconst sockets = [];\nconst users = {};\nlet socket = null;\n\nconst socketServer = (io) => {\n    io.on('connection', (client) => {\n        socket = client;\n        sockets.push(client);\n        users.lastConnected = client.id;\n        console.log('a user connected');\n        console.log(sockets.length);\n        client.on('disconnect', () => {\n            console.log('user disconnected');\n            for (let key in users) {\n                if (users[key] === client.id) {\n                    delete users[key];\n                    break;\n                }\n            }\n            sockets.splice(sockets.indexOf(client), 1);\n            socket = null;\n        });\n        client.on('login', ({username}) => {\n            console.log('login listener ', username);\n            client.emit('users.login', {username: 'fadi emit'});\n        });\n    });\n\n    io.listen(3092);\n    console.log('io connected on port 3092');\n    return io\n}\n\nexport default {\n    socketServer,\n    sockets,\n    socket,\n    users\n};\n"]}