{"version":3,"sources":["../../server/services/checkPermissions.js"],"names":["checkPermission","isOwner","req","res","next","user","id","permission","query","owner","body","params","validate","can","then","catch","status","send","success","error"],"mappings":";;;;;;;AAAA;;;;;;AAEA,IAAMA,kBAAkB,EAAxB;AACAA,gBAAgBC,OAAhB,GAA0B,UAAUC,GAAV,EAAeC,GAAf,EAAoBC,IAApB,EAA0B;AAAA,oBACrBF,IAAIG,IADiB;AAAA,QACxCC,EADwC,aACxCA,EADwC;AAAA,QACpCC,UADoC,aACpCA,UADoC;;AAAA,eAE9BL,IAAIM,KAAJ,CAAUC,KAAV,GAAkBP,IAAIM,KAAtB,GAA4BN,IAAIQ,IAAJ,CAASD,KAAT,GAAiBP,IAAIQ,IAArB,GAA2BR,IAAIS,MAF7B;AAAA,QAExCF,KAFwC,QAExCA,KAFwC;;AAGhD,QAAMG,WAAW,iCAAjB;AACAA,aAASC,GAAT,CAAaN,UAAb,EAAwB,MAAxB,EAAgC,EAACD,MAAD,EAAKG,YAAL,EAAhC,EACKK,IADL,CACU,YAAM;AACRV;AACH,KAHL,EAGOW,KAHP,CAGa,YAAM;AACfZ,YAAIa,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AACjBC,qBAAS,KADQ;AAEjBC,mBAAO;AAFU,SAArB;AAIH,KARD;AASH,CAbD;;QAeSnB,e,GAAAA,e","file":"checkPermissions.js","sourcesContent":["import RBAC, { roles } from '../config/roles';\n\nconst checkPermission = {};\ncheckPermission.isOwner = function (req, res, next) {\n    const { id, permission } = req.user;\n    const { owner } = req.query.owner ? req.query:req.body.owner ? req.body: req.params;\n    const validate = new RBAC(roles);\n    validate.can(permission,'edit', {id, owner})\n        .then(() => {\n            next()\n        }).catch(() => {\n        res.status(403).send({\n            success: false,\n            error: 'You don\\'t have a permission.'\n        })\n    });\n};\n\nexport { checkPermission };"]}